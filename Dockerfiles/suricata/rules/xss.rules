# Rilevamento XSS: Script semplice
alert http any any -> any any (msg:"XSS Attack Detected: <script> tag"; flow:established,to_server; content:"<script>"; nocase; classtype:web-application-attack; sid:1000001; rev:1;)

# Rilevamento XSS: Eventi JavaScript comuni
alert http any any -> any any (msg:"XSS Attack Detected: JavaScript event - onload"; flow:established,to_server; content:"onload="; nocase; classtype:web-application-attack; sid:1000002; rev:1;)
alert http any any -> any any (msg:"XSS Attack Detected: JavaScript event - onclick"; flow:established,to_server; content:"onclick="; nocase; classtype:web-application-attack; sid:1000003; rev:1;)
alert http any any -> any any (msg:"XSS Attack Detected: JavaScript event - onmouseover"; flow:established,to_server; content:"onmouseover="; nocase; classtype:web-application-attack; sid:1000004; rev:1;)

# Rilevamento XSS: Common JS Functions
alert http any any -> any any (msg:"XSS Attack Detected: JavaScript alert()"; flow:established,to_server; content:"alert("; nocase; classtype:web-application-attack; sid:1000005; rev:1;)
alert http any any -> any any (msg:"XSS Attack Detected: JavaScript eval()"; flow:established,to_server; content:"eval("; nocase; classtype:web-application-attack; sid:1000006; rev:1;)
alert http any any -> any any (msg:"XSS Attack Detected: JavaScript prompt()"; flow:established,to_server; content:"prompt("; nocase; classtype:web-application-attack; sid:1000007; rev:1;)
alert http any any -> any any (msg:"XSS Attack Detected: JavaScript confirm()"; flow:established,to_server; content:"confirm("; nocase; classtype:web-application-attack; sid:1000008; rev:1;)

# Rilevamento XSS: Iframe injection
alert http any any -> any any (msg:"XSS Attack Detected: <iframe> tag"; flow:established,to_server; content:"<iframe"; nocase; classtype:web-application-attack; sid:1000009; rev:1;)

# Rilevamento XSS: Image tag with JavaScript
alert http any any -> any any (msg:"XSS Attack Detected: <img> tag with JavaScript"; flow:established,to_server; content:"<img"; nocase; content:"src="; content:"javascript:"; nocase; classtype:web-application-attack; sid:1000010; rev:1;)

# Rilevamento XSS: Malicious HTML entities
alert http any any -> any any (msg:"XSS Attack Detected: HTML entity - &lt;"; flow:established,to_server; content:"&lt;script&gt;"; nocase; classtype:web-application-attack; sid:1000011; rev:1;)
alert http any any -> any any (msg:"XSS Attack Detected: HTML entity - &#x"; flow:established,to_server; content:"&#x"; content:"script"; nocase; classtype:web-application-attack; sid:1000012; rev:1;)

# Rilevamento XSS: Data URI
alert http any any -> any any (msg:"XSS Attack Detected: Data URI"; flow:established,to_server; content:"data:text/html"; nocase; classtype:web-application-attack; sid:1000013; rev:1;)

# Rilevamento XSS: VBScript
alert http any any -> any any (msg:"XSS Attack Detected: VBScript"; flow:established,to_server; content:"<script"; content:"vbscript:"; nocase; classtype:web-application-attack; sid:1000014; rev:1;)

# Rilevamento XSS: Uso di document.write
alert http any any -> any any (msg:"XSS Attack Detected: document.write"; flow:established,to_server; content:"document.write("; nocase; classtype:web-application-attack; sid:1000015; rev:1;)

# Rilevamento XSS: Uso di innerHTML
alert http any any -> any any (msg:"XSS Attack Detected: innerHTML"; flow:established,to_server; content:"innerHTML"; nocase; classtype:web-application-attack; sid:1000016; rev:1;)

# Rilevamento XSS: Uso di document.cookie
alert http any any -> any any (msg:"XSS Attack Detected: document.cookie"; flow:established,to_server; content:"document.cookie"; nocase; classtype:web-application-attack; sid:1000017; rev:1;)

# Custom
alert http any any -> any any (msg:"Possible XSS attack, script tag"; content:"script"; nocase; pcre:"/(<|%3C|%253C)script/smi"; classtype:web-application-attack; sid:50100001; rev:1;)
alert http any any -> any any (msg:"Possible XSS attack, js event handler"; content:"on"; nocase; pcre:"/on\w+(%3D|=)/smi"; classtype:web-application-attack; sid:50100002; rev:1;)
alert http any any -> any any (msg:"Possible XSS attack, js protocol"; content:"javascript"; nocase; pcre:"/javascript(:|%3A)/smi"; classtype:web-application-attack; sid:50100003; rev:1;)
